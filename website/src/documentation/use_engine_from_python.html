[%
  title='MyMediaLite: How to use a recommender engine in Python'
  prefix='../'
%]

[% INCLUDE header %]

<h1><a href="index.html">[% title %]</a></h1>

[% INCLUDE menu %]

[% INCLUDE infobox %]

<div id="content">
  <p>
     On this page, we show how to first set up recommender engines in Python,
     and then use them to make predictions.
  </p>
  
  <p>
    To use the examples on this page,
    <a href="http://www.grouplens.org/node/73">download the MovieLens 100k ratings dataset from the
    GroupLens Research website</a> and unzip it.
    <br/>
    Of course you can also use your own data ;-)
  </p>  
  
  <h2>IronPython</h2>
  
  <p>
  [% INCLUDE link link='ironpython' %] lets you run Python programs on the .NET platform.
  It also lets you use .NET libraries (<tt>.dll</tt>s) like MyMediaLite.
  </p>
  
  <p>
    To run a program with IronPython, type <tt>ipy program.py</tt> in the command line,
    where <tt>program.py</tt> is your program.
  </p>
  
  <p>
    You may also enter just <tt>ipy</tt>, so that you can use IronPython's REPL interactively.
  </p>
  
  <h2>Rating Prediction</h2>
  <p>
  <!-- TODO syntax highlighting -->
  <pre>
  import clr
  clr.AddReference("MyMediaLite.dll")
  import MyMediaLite

  min_rating = 1
  max_rating = 5

  # load the data
  user_mapping = MyMediaLite.data.EntityMapping()
  item_mapping = MyMediaLite.data.EntityMapping()
  training_data = MyMediaLite.io.RatingPredictionData.Read("u1.base", min_rating, max_rating, user_mapping, item_mapping)
  test_data = MyMediaLite.io.RatingPredictionData.Read("u1.test", min_rating, max_rating, user_mapping, item_mapping)

  # set up the recommender
  recommender = MyMediaLite.rating_predictor.UserItemBaseline()
  recommender.MinRating = min_rating
  recommender.MaxRating = max_rating
  recommender.Ratings = training_data
  recommender.Train()

  # measure the accuracy on the test data set
  print MyMediaLite.eval.RatingEval.EvaluateRated(recommender, test_data)

  # make a prediction for a certain user and item
  print recommender.Predict(user_mapping.ToInternalID(1), item_mapping.ToInternalID(1))  
  </pre>
  </p>

  <h2>Item Prediction from Implicit Feedback</h2>
  <p>
  <pre>
  import clr
  clr.AddReference("MyMediaLite.dll")
  import MyMediaLite

  # load the data
  user_mapping = MyMediaLite.data.EntityMapping()
  item_mapping = MyMediaLite.data.EntityMapping()
  training_data = MyMediaLite.io.ItemRecommenderData.Read("u1.base", user_mapping, item_mapping)
  relevant_items = item_mapping.InternalIDs
  test_data = MyMediaLite.io.ItemRecommenderData.Read("u1.test", user_mapping, item_mapping)

  # set up the recommender
  recommender = MyMediaLite.item_recommender.MostPopular()
  recommender.SetCollaborativeData(training_data);
  recommender.Train()

  # measure the accuracy on the test data set
  print MyMediaLite.eval.ItemPredictionEval.EvaluateItemRecommender(recommender, test_data, training_data, relevant_items)

  # make a prediction for a certain user and item
  print recommender.Predict(user_mapping.ToInternalID(1), item_mapping.ToInternalID(1))
  </pre>
  </p>
</div>

[% INCLUDE footer %]
